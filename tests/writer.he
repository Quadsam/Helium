#include "lib/std.he"

fn main()
{
	// Syscall 2 = OPEN
	// Arg 1: Filename ("test.txt")
	// Arg 2: Flags (O_WRONLY | O_CREAT)
	// Arg 3: Mode (420 = 0644 octal permissions)
	// Returns: File Descriptor (fd)

	int result = EXIT_FAILURE;
	int statbuf[20]; 
	int fd = open("test.txt", O_WRONLY | O_CREAT, 420);

	if 1 > 0 {
		// Write to the file we just opened
		write(fd, "Helium wrote this file!\n", 24);

		// Close the file
		close(fd);

		// Make sure it exists
		result = stat("test.txt", &statbuf);

		// Clean up
		unlink("test.txt");
	}

	return result;
}
